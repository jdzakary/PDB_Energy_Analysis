## full-atom omega-oxidation to uronic acid patch

NAME uronic_acid
TYPES URONIC_ACID_VARIANT

BEGIN_SELECTOR
PROPERTY CARBOHYDRATE
NOT VARIANT_TYPE URONIC_ACID_VARIANT
END_SELECTOR

BEGIN_CASE  ## ALDOTRIOSE ####################################################

BEGIN_SELECTOR
PROPERTY ALDOSE
PROPERTY TRIOSE
NOT PROPERTY OXETOSE  # Make sure the omega carbon is free for oxidation.
NOT UPPER_ATOM O3
NOT VARIANT_TYPE C3_BRANCH_POINT
NOT PROPERTY C3_MODIFIED
END_SELECTOR

# TODO: Fill in later.

ADD_PROPERTY C3_MODIFIED
ADD_PROPERTY URONIC_ACID

END_CASE


BEGIN_CASE  ## KETOTRIOSE ####################################################

BEGIN_SELECTOR
PROPERTY KETOSE
PROPERTY TRIOSE
NOT PROPERTY OXIROSE  # Make sure the omega carbon is free for oxidation.
NOT UPPER_ATOM O3
NOT VARIANT_TYPE C3_BRANCH_POINT
NOT PROPERTY C3_MODIFIED
END_SELECTOR

# TODO: Fill in later.

ADD_PROPERTY C3_MODIFIED
ADD_PROPERTY URONIC_ACID

END_CASE


BEGIN_CASE  ## ALDOTETROSE ###################################################

BEGIN_SELECTOR
PROPERTY ALDOSE
PROPERTY TETROSE
NOT PROPERTY FURANOSE  # Make sure the omega carbon is free for oxidation.
NOT UPPER_ATOM O4
NOT VARIANT_TYPE C4_BRANCH_POINT
NOT PROPERTY C4_MODIFIED
END_SELECTOR

# TODO: Fill in later.

ADD_PROPERTY C4_MODIFIED
ADD_PROPERTY URONIC_ACID

END_CASE


BEGIN_CASE  ## KETOTETROSE ###################################################

BEGIN_SELECTOR
PROPERTY KETOSE
PROPERTY TETROSE
PROPERTY OXETOSE  # Make sure the omega carbon is free for oxidation.
NOT UPPER_ATOM O4
NOT VARIANT_TYPE C4_BRANCH_POINT
NOT PROPERTY C4_MODIFIED
END_SELECTOR

# TODO: Fill in later.

ADD_PROPERTY C4_MODIFIED
ADD_PROPERTY URONIC_ACID

END_CASE


BEGIN_CASE  ## ALDOPENTOSE ###################################################

BEGIN_SELECTOR
PROPERTY ALDOSE
PROPERTY PENTOSE
NOT PROPERTY PYRANOSE  # Make sure the omega carbon is free for oxidation.
NOT UPPER_ATOM O5
NOT VARIANT_TYPE C5_BRANCH_POINT
NOT PROPERTY C5_MODIFIED
END_SELECTOR

# TODO: Fill in later.

ADD_PROPERTY C5_MODIFIED
ADD_PROPERTY URONIC_ACID

END_CASE


BEGIN_CASE  ## KETOPENTOSE ###################################################

BEGIN_SELECTOR
PROPERTY KETOSE
PROPERTY PENTOSE
NOT PROPERTY FURANOSE  # Make sure the omega carbon is free for oxidation.
NOT UPPER_ATOM O5
NOT VARIANT_TYPE C5_BRANCH_POINT
NOT PROPERTY C5_MODIFIED
END_SELECTOR

# TODO: Fill in later.

ADD_PROPERTY C5_MODIFIED
ADD_PROPERTY URONIC_ACID

END_CASE


BEGIN_CASE  ## ALDOHEXOSE ####################################################

BEGIN_SELECTOR
PROPERTY ALDOSE
PROPERTY HEXOSE
NOT PROPERTY SEPTANOSE  # Make sure the omega carbon is free for oxidation.
NOT UPPER_ATOM O6
NOT VARIANT_TYPE C6_BRANCH_POINT
NOT PROPERTY C6_MODIFIED
END_SELECTOR

# First, remove atoms.
DELETE_ATOM 1H6
DELETE_ATOM 2H6

# Keep O6 and HO6 virtual for use as placeholders for chis.
SET_ATOM_TYPE HO6 VIRT
SET_MM_ATOM_TYPE HO6 VIRT
SET_ATOMIC_CHARGE HO6 0.00

SET_ATOM_TYPE O6 VIRT
SET_MM_ATOM_TYPE O6 VIRT
SET_ATOMIC_CHARGE O6 0.00

# Next, rehybridize C6.
SET_ATOM_TYPE  C6  COO
SET_MM_ATOM_TYPE  C6  CC
SET_ATOMIC_CHARGE  C6  0.21
RESET_BOND_LENGTH  C6  1.526

# Next, add the new atoms.
ADD_ATOM 1O6  OOC  OC  -0.64
ADD_ATOM 2O6  OOC  OC  -0.64

ADD_BOND_TYPE  C6  1O6  CARBOXY
ADD_BOND_TYPE  C6  2O6  CARBOXY

REDEFINE_CHI 5  C4   C5   C6  1O6  # So, technically, chi5 is ambiguous for a furanose ring here, but I'll deal with that later.  I'll need even more finely divided cases.  Grr. ~Labonte
CLEAR_CHI_ROTAMERS  5
ADD_CHI_ROTAMER 5  60 0
ADD_CHI_ROTAMER 5 120 0

# This chi no longer has a meaning, so remove all of its rotamer bins.
CLEAR_CHI_ROTAMERS 6

SET_ICOOR  1O6   131.662   62.557  1.255  C6    C5    C4
SET_ICOOR  2O6   -45.1126  62.557  1.255  C6    C5    C4

ADD_PROPERTY C6_MODIFIED
ADD_PROPERTY URONIC_ACID

END_CASE


BEGIN_CASE  ## KETOHEXOSE ####################################################

BEGIN_SELECTOR
PROPERTY KETOSE
PROPERTY HEXOSE
NOT PROPERTY PYRANOSE  # Make sure the omega carbon is free for oxidation.
NOT UPPER_ATOM O6
NOT VARIANT_TYPE C6_BRANCH_POINT
NOT PROPERTY C6_MODIFIED
END_SELECTOR

# First, remove atoms.
DELETE_ATOM  HO6
DELETE_ATOM  O6

# Next, add the new atoms.


ADD_PROPERTY C6_MODIFIED
ADD_PROPERTY URONIC_ACID

END_CASE


BEGIN_CASE  ## ALDOHEPTOSE ###################################################

BEGIN_SELECTOR
PROPERTY ALDOSE
PROPERTY HEPTOSE
#NOT PROPERTY WHATEVER_THE_HECK_WE_CALL_AN_EIGHT_MEMEBERED_CYCLE  # Make sure the omega carbon is free for oxidation.
NOT UPPER_ATOM O7
NOT VARIANT_TYPE C7_BRANCH_POINT
NOT PROPERTY C7_MODIFIED
END_SELECTOR

# TODO: Fill in later.

ADD_PROPERTY C7_MODIFIED
ADD_PROPERTY URONIC_ACID

END_CASE


BEGIN_CASE  ## KETOHEPTOSE ###################################################

BEGIN_SELECTOR
PROPERTY KETOSE
PROPERTY HEPTOSE
NOT PROPERTY SEPTANOSE  # Make sure the omega carbon is free for oxidation.
NOT UPPER_ATOM O7
NOT VARIANT_TYPE C7_BRANCH_POINT
NOT PROPERTY C7_MODIFIED
END_SELECTOR

# TODO: Fill in later.

ADD_PROPERTY C7_MODIFIED
ADD_PROPERTY URONIC_ACID

END_CASE


BEGIN_CASE  ## OCTOSE ########################################################

BEGIN_SELECTOR
PROPERTY OCTOSE
NOT UPPER_ATOM O8
NOT VARIANT_TYPE C8_BRANCH_POINT
NOT PROPERTY C8_MODIFIED
END_SELECTOR

# TODO: Fill in later.

ADD_PROPERTY C8_MODIFIED
ADD_PROPERTY URONIC_ACID

END_CASE


BEGIN_CASE  ## NONOSE ########################################################

BEGIN_SELECTOR
PROPERTY NONOSE
NOT UPPER_ATOM O9
NOT VARIANT_TYPE C9_BRANCH_POINT
NOT PROPERTY C9_MODIFIED
END_SELECTOR

# TODO: Fill in later.

ADD_PROPERTY C9_MODIFIED
ADD_PROPERTY URONIC_ACID

END_CASE
