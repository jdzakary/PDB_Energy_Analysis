## allows addition of a 3' 'side-chain' phosphate which can be packed.
NAME 3PrimePhos
TYPES  THREE_PRIME_PHOSPHATE

BEGIN_SELECTOR
PROPERTY RNA
NOT VARIANT_TYPE THREE_PRIME_END_OH
NOT VARIANT_TYPE FIVE_PRIME_END_OH
NOT VARIANT_TYPE BULGE
NOT VARIANT_TYPE VIRTUAL_RNA_RESIDUE_EXCLUDE_PHOSPHATE
NOT VARIANT_TYPE VIRTUAL_RNA_RESIDUE
#NOT VARIANT_TYPE VIRTUAL_RIBOSE, should ideally have this constraint on, but otherwise removing/adding variants is a pain.
NOT VARIANT_TYPE VIRTUAL_BASE_HEAVY_ATOM
NOT VARIANT_TYPE VIRTUAL_BACKBONE_EXCEPT_C1PRIME
NOT VARIANT_TYPE CUTPOINT_LOWER
END_SELECTOR

BEGIN_CASE ### general case ###

ADD_ATOM YP   Phos H   1.5
ADD_ATOM YOP2 OOC  H   -0.78
ADD_ATOM YOP1 OOC  H   -0.78
ADD_ATOM YO5' ONH2 H   -0.57

ADD_BOND YP    O3'
ADD_BOND YP   YOP2
ADD_BOND YP   YOP1
ADD_BOND YP   YO5'

SET_ICOOR   YP   -139.954848   59.821530    1.607226   O3'   C3'   C4' # from print_icoord
SET_ICOOR   YO5'    0.000000   76.024713    1.593589  YP     O3'   C3' # from print_icoord
SET_ICOOR   YOP2  114.557126   71.959402    1.484470  YP     O3'  YO5' # from print_icoord
SET_ICOOR   YOP1  130.814214   71.928445    1.484214  YP     O3'  YOP2 # from print_icoord

SET_BACKBONE_HEAVYATOM YP
SET_BACKBONE_HEAVYATOM YOP1
SET_BACKBONE_HEAVYATOM YOP2
SET_BACKBONE_HEAVYATOM YO5'
END_CASE
