## full-atom N-linked conjugation patches for lysine/ornithine
## This patch is used for N-linked glycosylation and ubiquitination.

NAME N-conjugated
TYPES SC_BRANCH_POINT

BEGIN_SELECTOR
PROPERTY PROTEIN
NOT VARIANT_TYPE SC_BRANCH_POINT
NOT VARIANT_TYPE PHOSPHORYLATION
NOT VARIANT_TYPE SULFATION
NOT VARIANT_TYPE DEPROTONATED
NOT VARIANT_TYPE METHYLATION
NOT VARIANT_TYPE DIMETHYLATION
NOT VARIANT_TYPE TRIMETHYLATION
NOT VARIANT_TYPE ACETYLATION
PROPERTY SIDECHAIN_AMINE
END_SELECTOR


BEGIN_CASE  ## Lysine #########################################################

BEGIN_SELECTOR
AA LYS DLY
END_SELECTOR

# have to delete all protons because bad geometry
DELETE_ATOM 3HZ

SET_ATOM_TYPE 2HZ VIRT
SET_MM_ATOM_TYPE 2HZ VIRT
SET_ICOOR 2HZ   178.15  59.31  1.375   NZ   CE   CD

SET_ATOM_TYPE NZ NH2O
SET_MM_ATOM_TYPE NZ NH2
#1HZ atom type stays the same--still Hpol
SET_MM_ATOM_TYPE 1HZ H

ADD_CONNECT NZ ICOOR  178.15  59.31  1.375   NZ   CE   CD
SET_ICOOR 1HZ   180.00  60.00  1.010  NZ   CE   CONN%LASTCONN

SET_ATOMIC_CHARGE NZ -0.47
SET_ATOMIC_CHARGE 1HZ 0.31

ADD_PROPERTY BRANCH_POINT
DELETE_PROPERTY CHARGED

END_CASE

BEGIN_CASE  ## ornithine ######################################################

BEGIN_SELECTOR
NAME3 ORN
END_SELECTOR

# have to delete all protons because bad geometry
DELETE_ATOM 3HE

SET_ATOM_TYPE 2HE VIRT
SET_MM_ATOM_TYPE 2HE VIRT
SET_ICOOR 2HE   178.15  59.31  1.375   NE   CD   CG

SET_ATOM_TYPE NE NH2O
SET_MM_ATOM_TYPE NE NH2
#1HE atom type stays the same--still Hpol
SET_MM_ATOM_TYPE 1HE H

ADD_CONNECT NE ICOOR  178.15  59.31  1.375   NE   CD   CG
SET_ICOOR 1HE   180.00  60.00  1.010  NE   CD   CONN%LASTCONN

SET_ATOMIC_CHARGE NE -0.47
SET_ATOMIC_CHARGE 1HE 0.31

ADD_PROPERTY BRANCH_POINT
DELETE_PROPERTY CHARGED

END_CASE
