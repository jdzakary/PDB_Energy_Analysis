NAME 5prime_end_OH
TYPES  FIVE_PRIME_END_OH

BEGIN_SELECTOR
PROPERTY RNA DNA
NOT VARIANT_TYPE FIVE_PRIME_END_OH
NOT VARIANT_TYPE THREE_PRIME_END_OH
NOT VARIANT_TYPE BULGE
NOT VARIANT_TYPE VIRTUAL_RNA_RESIDUE_EXCLUDE_PHOSPHATE
NOT VARIANT_TYPE VIRTUAL_RNA_RESIDUE
NOT VARIANT_TYPE VIRTUAL_RIBOSE
NOT VARIANT_TYPE VIRTUAL_BASE_HEAVY_ATOM
NOT VARIANT_TYPE VIRTUAL_BACKBONE_EXCEPT_C1PRIME
NOT VARIANT_TYPE FIVEPRIME_CAP
NOT VARIANT_TYPE VIRTUAL_DNA_PHOSPHATE # also adds HO5'
END_SELECTOR

BEGIN_CASE ### general case ###
BEGIN_SELECTOR
NAME3 BRU
END_SELECTOR

SET_IO_STRING U33 U

SET_ATOM_TYPE P VIRT
SET_ATOMIC_CHARGE P 0
SET_ATOM_TYPE OP2 VIRT
SET_ATOMIC_CHARGE OP2 0
SET_ATOM_TYPE OP1 VIRT
SET_ATOMIC_CHARGE OP1 0
SET_ATOM_TYPE O5' OH
SET_ATOMIC_CHARGE O5' -0.5

ADD_ATOM HO5'  Hpol H   0.38
ADD_BOND O5'   HO5'
SET_ICOOR HO5'  179.890442   70.479956    1.000437   O5'   C5'   C4'

END_CASE

BEGIN_CASE ### No OP2 ###
BEGIN_SELECTOR
NAME3 SSA SSC SSG SSU
END_SELECTOR

SET_ATOM_TYPE P VIRT
SET_ATOMIC_CHARGE P 0
SET_ATOM_TYPE SP2 VIRT
SET_ATOMIC_CHARGE SP2 0
SET_ATOM_TYPE OP1 VIRT
SET_ATOMIC_CHARGE OP1 0
SET_ATOM_TYPE O5' OH
SET_ATOMIC_CHARGE O5' -0.5

ADD_ATOM HO5'  Hpol H   0.38
ADD_BOND O5'   HO5'
SET_ICOOR HO5'  179.890442   70.479956    1.000437   O5'   C5'   C4'

END_CASE

BEGIN_CASE ### No OP1 ###
BEGIN_SELECTOR
NAME3 SRA SRC SRG SRU
END_SELECTOR

SET_ATOM_TYPE P VIRT
SET_ATOMIC_CHARGE P 0
SET_ATOM_TYPE OP2 VIRT
SET_ATOMIC_CHARGE OP2 0
SET_ATOM_TYPE SP1 VIRT
SET_ATOMIC_CHARGE SP1 0
SET_ATOM_TYPE O5' OH
SET_ATOMIC_CHARGE O5' -0.5

ADD_ATOM HO5'  Hpol H   0.38
ADD_BOND O5'   HO5'
SET_ICOOR HO5'  179.890442   70.479956    1.000437   O5'   C5'   C4'

END_CASE

BEGIN_CASE ### general case ###
BEGIN_SELECTOR
NAME3 CYT
END_SELECTOR

SET_ATOM_TYPE P VIRT
SET_ATOMIC_CHARGE P 0
SET_ATOM_TYPE OP2 VIRT
SET_ATOMIC_CHARGE OP2 0
SET_ATOM_TYPE OP1 VIRT
SET_ATOMIC_CHARGE OP1 0
SET_ATOM_TYPE O5' OH
SET_ATOMIC_CHARGE O5' -0.5

ADD_ATOM HO5'  Hpol H   0.38
ADD_BOND O5'   HO5'
SET_ICOOR HO5'  179.890442   70.479956    1.000437   O5'   C5'   C4'

SET_IO_STRING DCZ c

END_CASE

BEGIN_CASE ### general case ###
SET_ATOM_TYPE P VIRT
SET_ATOMIC_CHARGE P 0
SET_ATOM_TYPE OP2 VIRT
SET_ATOMIC_CHARGE OP2 0
SET_ATOM_TYPE OP1 VIRT
SET_ATOMIC_CHARGE OP1 0
SET_ATOM_TYPE O5' OH
SET_ATOMIC_CHARGE O5' -0.5

ADD_ATOM HO5'  Hpol H   0.38
ADD_BOND O5'   HO5'
SET_ICOOR HO5'  179.890442   70.479956    1.000437   O5'   C5'   C4'

END_CASE
