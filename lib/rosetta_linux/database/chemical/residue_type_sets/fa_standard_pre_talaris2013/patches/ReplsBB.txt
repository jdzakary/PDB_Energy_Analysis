## this patch turns all protein residue backbone atoms (N,H,C,O, [1H, 2H, OXT]) into virtual atoms
## can be useful if you want sidechain-only energy terms, while still allowing residue repacking
NAME ProteinReplsBB
TYPES  REPLS_BB

BEGIN_SELECTOR
PROPERTY PROTEIN
END_SELECTOR

BEGIN_CASE ### upper-cutpoint ###
BEGIN_SELECTOR
VARIANT_TYPE CUTPOINT_UPPER
END_SELECTOR

SET_ATOM_TYPE N REPLS
SET_ATOM_TYPE C REPLS
SET_ATOM_TYPE O REPLS
END_CASE


BEGIN_CASE ### lower-cutpoint ###
BEGIN_SELECTOR
VARIANT_TYPE CUTPOINT_LOWER
END_SELECTOR

SET_ATOM_TYPE N REPLS
SET_ATOM_TYPE C REPLS
SET_ATOM_TYPE O REPLS
END_CASE


BEGIN_CASE  ### N-terminal proline ###
BEGIN_SELECTOR
VARIANT_TYPE LOWER_TERMINUS_VARIANT
AA PRO
END_SELECTOR

SET_ATOM_TYPE N REPLS
SET_ATOM_TYPE C REPLS
SET_ATOM_TYPE O REPLS
SET_ATOM_TYPE 1H HREPS
SET_ATOM_TYPE 2H HREPS
END_CASE


BEGIN_CASE  ### N-terminus ###
BEGIN_SELECTOR
VARIANT_TYPE LOWER_TERMINUS_VARIANT
END_SELECTOR

SET_ATOM_TYPE N REPLS
SET_ATOM_TYPE C REPLS
SET_ATOM_TYPE O REPLS
SET_ATOM_TYPE 1H HREPS
SET_ATOM_TYPE 2H HREPS
SET_ATOM_TYPE 3H HREPS
END_CASE


BEGIN_CASE  ### C-terminus ###
BEGIN_SELECTOR
VARIANT_TYPE UPPER_TERMINUS_VARIANT
END_SELECTOR

SET_ATOM_TYPE N REPLS
SET_ATOM_TYPE C REPLS
SET_ATOM_TYPE O REPLS
SET_ATOM_TYPE OXT REPLS
END_CASE


BEGIN_CASE ### Proline ###
BEGIN_SELECTOR
AA PRO
END_SELECTOR

SET_ATOM_TYPE N REPLS
SET_ATOM_TYPE C REPLS
SET_ATOM_TYPE O REPLS
END_CASE


BEGIN_CASE ### general case ###
SET_ATOM_TYPE N REPLS
SET_ATOM_TYPE H HREPS
SET_ATOM_TYPE C REPLS
SET_ATOM_TYPE O REPLS
END_CASE
